<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分店資訊</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="font-awesome/css/all.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lobster+Two:wght@700&family=Passion+One&display=swap');

        .carousel-caption {
            top: 0px;
            bottom: 0px;
        }

        ;

        @import url('https://fonts.googleapis.com/css2?family=Lobster+Two:wght@700&display=swap');

    </style>
</head>

<body>
    <script src="https://cdn.lordicon.com/fudrjiwc.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <!-- 1: ads header -->
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://images.unsplash.com/photo-1588421357574-87938a86fa28?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">FREE
                        SHIPPING ON ALL ORDERS!</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1557682260-96773eb01377?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1129&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block px-3">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">2023
                        SPRING NEW COLLECTIONS!</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1557682250-33bd709cbe85?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1129&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block px-3">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">SURFING
                        DAY AT KA'UAI</a>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <!-- 2: banner -->
    <section>
        <div class="container">
            <div class="text-end">
                <a href="#" style="text-decoration:none">TEAM SALES</a>
                <a href="#" style="text-decoration:none">EVENTS</a>
            </div>
        </div>
    </section>

    <!-- 3: navbar1 -->
    <section>
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" href="swimwear_homepage.html">
                    <div class="box" style="background-color:#ff6f69; padding: 10px;">
                        <h1 style="font-family: Lobster Two; color:white" href="">naru</h1>
                    </div>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;">
                                <div class="box" style="padding:10px">
                                    <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">SWIMSUIT</h3>
                                </div>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">One Piece</a></li>
                                <li><a class="dropdown-item" href="#">Bikini Tops</a></li>
                                <li><a class="dropdown-item" href="#">Bikini Buttoms</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="items_page.html">All Swimsuit</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;">
                                <div class="box" style="padding:10px">
                                    <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">LIMITED EDITION
                                        PRINT</h3>
                                </div>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;">
                                <div class="box" style="padding:10px">
                                    <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">CLOTHING</h3>
                                </div>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">Hoodie</a></li>
                                <li><a class="dropdown-item" href="#">Dress</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">Accessory</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="store_map.html"
                                style="font-family: Passion One; color: #ff6f69; font-size:35px">STORES</a>
                        </li>
                    </ul>
                    <section>
                        <div class="text-end">
                            <button class="btn"><i class="fa-solid fa-magnifying-glass fa-2xl">
                                </i></button>
                            <a href="login_page.html"><i class="fa-regular fa-user fa-2xl">
                                </i></a>
                            <button class="btn"><i class="fa-solid fa-cart-shopping fa-2xl"></i></button>
                        </div>
                    </section>
                </div>
            </div>
        </nav>
    </section>

    <!-- 4. center -->
    <section>
        <div class="row">
            <div class="col-md-3">
                <div class="box" style="background-color: #ff6f69 ;">
                    <h1 class="mt-3" style="color:white;font-weight: 900; text-align: center;">分店資訊
                        <select class="form-select-lg" aria-label="Default select example" id="district"
                            style="text-align: center; font-weight: 700;">
                            <option></option>
                        </select>
                    </h1>
                    <div class="box mt-3; region_list" style="background-color: white;overflow: scroll;">
                        <ul class="list-group" id="listData">
                            <li>yee</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="vh-100" id="map"></div>
            </div>
        </div>
    </section>

    <!-- 7: grey information area -->
    <section>
        <div class="row" style="background-color:#D3D3D3">
            <div class="container mt-3 p-5">
                <h1 style="text-align:center;font-weight:900;">Lorem, ipsum dolor sit amet c</h1>
                <h3 style="text-align:center">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt
                    deleniti repellat voluptatem fugiat veritatis rem ab ratione quo repudiandae omnis placeat, aliquam
                    reiciendis Lorem ipsum dolor, sit amet consectetur adipisicing elit. Eligendi quis quam ipsam aut
                    cupiditate vero pariatur facilis inventore dicta recusandae.<br><br></h3>
                <a href="#" style="text-align: center; color:black">
                    <h3>LEARN MORE</h3>
                </a>
            </div>
        </div>
    </section>
    <!-- 8: bottom -->
    <section class="" style="background-color:#ff6f69">
        <div class="container" style="color:white">
            <div class="row">
                <div class="d-flex justify-content-start">
                    <div class="col-md-4 text-center">
                        <div class="fs-3 mt-5">Get our updates in your inbox.</div>
                        <div class="box mt-1" style="background-color:black; height:5px;"></div>
                        <p class="mt-3">* By completing this form you are signing up to receive our emails and can
                            unsubscribe at any time.</p>
                    </div>
                    <div class="d-flex align-item-center justify-content-end">
                        <div class="col-md-4 text-center">
                            <div class="fs-4">Company</div>
                            <a href="#">About us</a>
                            <a href="#">Blog</a>
                            <a href="#">Event</a>
                        </div>
                    </div>
                    <div class="d-flex align-item-center justify-content-end">
                        <div class="col-md-4 text-center">
                            <div class="fs-4">Support</div>
                            <a href="#">Contact us</a>
                            <a href="#">FAQ</a>
                            <a href="#">RETURN</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.6.1.min.js"></script>
    <script src="js/youbike_immediate.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
    <script src="js/leaflet-color-markers.js"></script>
    <script src="js/leaflet.markercluster.js"></script>
    <script>
        var ubikeData = []; //所有ubike的資料
        var selectDistrict = ''; //已選取的台北市區
        var map;
        $(function () {
            //地圖
            $(function () {
                map = L.map('map').setView([25.0169639, 121.2261861], 10);

                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);

                var markers = new L.markerClusterGroup().addTo(map);

                //取得使用者座標位置並標出marker
                // if(navigator.geolocation){
                //     navigator.geolocation.getCurrentPosition(showPosition);
                // }else{
                //     console.log("Geolocation is not supported by this browser");
                // }
            })
            // 先把資料庫抓近來
            $.ajax({
                type: "GET",
                url: "https://tcgbusfs.blob.core.windows.net/dotapp/youbike/v2/youbike_immediate.json",
                dataType: "json",
                async: false,
                success: function (data) {
                    // 設一個參數給他
                    ubikeData = data;
                    console.log(ubikeData);
                },
                error: function () {
                    alert("error-");
                }
            });

            console.log(taipei_district);
            $("#district").append('<option disabled selected>----區域----</option>');
            taipei_district.forEach(function (item) {
                var strHTML = '<option>' + item + '</option>';
                $("#district").append(strHTML);
            })

            // 監聽，如果#district的按鈕資料改變，把選取的資料放入變數selectDistrict中，其中的所有ubike資料放進陣列bikeData裡
            $("#district").change(function () {
                selectDistrict = $(this).val();
                console.log(selectDistrict);
                var bikeData = []; //儲存挑選後單一區域ubikeData資料
                ubikeData.find(function (item) {
                    //從ubikeData.js檔尋找同樣的區域，放進bikeData
                    if (item.sarea == selectDistrict) {
                        bikeData.push(item);
                    }
                });
                console.log(bikeData);

                // 點選之後，比例尺變大
                // 水滴在區域更改之後就消失
                $("#listData").empty();
                removeMarker();

                bikeData.forEach(function (item, key) {
                    var strHTML03 = '<li class="list-group-item"><p class="h3">站點查詢:' + item.sna + '</p><p class="h3">站點位置:' + item.ar + '</p><p class="h3">可借車輛: ' + item.sbi + '輛</p><p class="h3">可停空位:' + item.bemp + ' 輛</p></li>';
                    $("#listData").append(strHTML03);

                    var lat = item.lat;
                    var lng = item.lng;
                    L.marker([lat, lng]).addTo(map)
                        .bindPopup('<div class="card" style="width: 18rem;"><div class="card-body"><h5 class="card-title">' + item.sna + '</h5><p class="card-text">' + item.ar + '</p><p class="h3">可借車輛: ' + item.sbi + '輛</p><p class="h3">可停空位:' + item.bemp + ' 輛</p></div></div>');


                    //變換區域時地圖轉移
                    if (key == Math.round(bikeData.length / 2)) {
                        panTo(lat, lng);
                    }

                })
            })


        })

        function removeMarker() {
            map.eachLayer(function (layer) {
                if (layer instanceof L.Marker) {
                    map.removeLayer(layer)
                }
            });
        }

    </script>
</body>

</html>